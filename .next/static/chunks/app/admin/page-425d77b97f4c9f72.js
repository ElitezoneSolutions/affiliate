(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{2699:function(e,s,t){Promise.resolve().then(t.bind(t,2399))},2399:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return N}});var a=t(7437),l=t(2265),n=t(4873),r=t(9376),i=t(2141),d=t(2869),c=t(6070),o=t(5613),x=t(2252),u=t(5805),m=t(8736),h=t(5252),p=t(8226);let f=(0,t(9763).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);var j=t(7648),y=t(872),g=t(821);function N(){let{user:e,signOut:s}=(0,n.a)(),t=(0,r.useRouter)(),[N,v]=(0,l.useState)(!0),[_,w]=(0,l.useState)(""),[b,Z]=(0,l.useState)({total_users:0,total_leads:0,pending_leads:0,approved_leads:0,total_payouts:0,pending_payouts:0,total_earnings:0,unpaid_earnings:0}),[k,O]=(0,l.useState)([]);(0,l.useEffect)(()=>{if(!e){t.replace("/login");return}if(!e.is_admin){t.replace("/dashboard");return}S()},[e,t]);let S=async()=>{try{v(!0),w("");let[{data:e,error:s},{data:t,error:a},{data:l,error:n}]=await Promise.all([i.O.from("users").select("id, is_admin"),i.O.from("leads").select("status, price, paid"),i.O.from("payout_requests").select("status, amount")]);if(s)throw s;if(a)throw a;if(n)throw n;let r=(null==e?void 0:e.length)||0,d=(null==t?void 0:t.length)||0,c=(null==t?void 0:t.filter(e=>"pending"===e.status).length)||0,o=(null==t?void 0:t.filter(e=>"approved"===e.status).length)||0,x=(null==t?void 0:t.filter(e=>"approved"===e.status).reduce((e,s)=>e+(s.price||0),0))||0,u=(null==t?void 0:t.filter(e=>"approved"===e.status&&!e.paid).reduce((e,s)=>e+(s.price||0),0))||0,m=(null==l?void 0:l.length)||0,h=(null==l?void 0:l.filter(e=>"requested"===e.status).length)||0;Z({total_users:r,total_leads:d,pending_leads:c,approved_leads:o,total_payouts:m,pending_payouts:h,total_earnings:x,unpaid_earnings:u});let{data:p,error:f}=await i.O.from("users").select("\n          id,\n          email,\n          first_name,\n          last_name,\n          is_admin,\n          created_at\n        ").eq("is_admin",!1).order("created_at",{ascending:!1});if(f)throw f;let j=(await Promise.all((p||[]).map(async e=>{let{data:s}=await i.O.from("leads").select("status, price, paid").eq("affiliate_id",e.id),t=(null==s?void 0:s.length)||0,a=(null==s?void 0:s.filter(e=>"approved"===e.status).length)||0,l=(null==s?void 0:s.filter(e=>"approved"===e.status).reduce((e,s)=>e+(s.price||0),0))||0,n=(null==s?void 0:s.filter(e=>"approved"===e.status&&!e.paid).reduce((e,s)=>e+(s.price||0),0))||0;return{...e,total_leads:t,approved_leads:a,total_earnings:l,unpaid_earnings:n,last_activity:e.created_at}}))).sort((e,s)=>s.total_earnings-e.total_earnings).slice(0,10);O(j)}catch(e){w(e.message)}finally{v(!1)}};return N||!e?(0,a.jsx)(g.T,{}):(0,a.jsx)(y.l,{children:(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[_&&(0,a.jsxs)(o.bZ,{variant:"destructive",className:"mb-6",children:[(0,a.jsx)(x.Z,{className:"h-4 w-4"}),(0,a.jsx)(o.X,{children:_})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ll,{className:"text-sm font-medium",children:"Total Users"}),(0,a.jsx)(u.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:b.total_users}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Registered affiliates"})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ll,{className:"text-sm font-medium",children:"Total Leads"}),(0,a.jsx)(m.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:b.total_leads}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[b.pending_leads," pending, ",b.approved_leads," approved"]})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ll,{className:"text-sm font-medium",children:"Total Earnings"}),(0,a.jsx)(h.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["$",b.total_earnings]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["$",b.unpaid_earnings," unpaid"]})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ll,{className:"text-sm font-medium",children:"Pending Payouts"}),(0,a.jsx)(p.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:b.pending_payouts}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Awaiting processing"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,a.jsx)(j.default,{href:"/admin/leads",children:(0,a.jsx)(c.Zb,{className:"hover:shadow-md transition-shadow cursor-pointer",children:(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(m.Z,{className:"h-5 w-5"}),"Manage Leads"]}),(0,a.jsx)(c.SZ,{children:"Review, approve, and manage all submitted leads"})]})})}),(0,a.jsx)(j.default,{href:"/admin/users",children:(0,a.jsx)(c.Zb,{className:"hover:shadow-md transition-shadow cursor-pointer",children:(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(u.Z,{className:"h-5 w-5"}),"User Management"]}),(0,a.jsx)(c.SZ,{children:"View all users, their earnings, and manage accounts"})]})})}),(0,a.jsx)(j.default,{href:"/admin/payouts",children:(0,a.jsx)(c.Zb,{className:"hover:shadow-md transition-shadow cursor-pointer",children:(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(p.Z,{className:"h-5 w-5"}),"Payout Management"]}),(0,a.jsx)(c.SZ,{children:"Process payout requests and manage payments"})]})})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(f,{className:"h-5 w-5"}),"Top Performing Users"]}),(0,a.jsx)(c.SZ,{children:"Users with the highest earnings"})]}),(0,a.jsx)(c.aY,{children:0===k.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(u.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"No users found"})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"User"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Total Leads"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Approved"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Total Earnings"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Unpaid"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:k.map(e=>(0,a.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-medium",children:[e.first_name," ",e.last_name]}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:e.email})]})}),(0,a.jsx)("td",{className:"py-3 px-4",children:e.total_leads}),(0,a.jsx)("td",{className:"py-3 px-4",children:e.approved_leads}),(0,a.jsxs)("td",{className:"py-3 px-4 font-medium",children:["$",e.total_earnings]}),(0,a.jsxs)("td",{className:"py-3 px-4",children:["$",e.unpaid_earnings]}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)(j.default,{href:"/admin/users/".concat(e.id),children:(0,a.jsx)(d.z,{variant:"outline",size:"sm",children:"View Details"})})})]},e.id))})]})})})]})]})})})}},821:function(e,s,t){"use strict";t.d(s,{T:function(){return l}});var a=t(7437);function l(){return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})})}},2252:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},8226:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},5252:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},5466:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},7692:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])}},function(e){e.O(0,[580,697,648,13,971,117,744],function(){return e(e.s=2699)}),_N_E=e.O()}]);